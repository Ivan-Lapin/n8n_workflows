# Автоматическое обновление данных из Excel в базу операторов

## Описание
Этот рабочий процесс (workflow) автоматизирует процесс обновления данных об эффективности операторов из Excel-файлов, загруженных в Google Drive, в централизованную таблицу Microsoft Excel.

## Принцип работы

### 1. Мониторинг новых файлов
- Workflow постоянно отслеживает появление новых файлов в специальной папке Google Drive
- Папка мониторинга: "Отчёт мастера"
- Частота проверки: каждую минуту

### 2. Обработка файлов
При появлении нового файла происходит следующая последовательность действий:

1. **Загрузка файла**
   - Автоматическая загрузка нового Excel-файла из Google Drive
   - Извлечение имени файла для определения периода отчета

2. **Извлечение данных**
   - Чтение содержимого Excel-файла
   - Парсинг данных о производительности операторов
   - Извлечение следующих показателей:
     * ФИО оператора (преобразуется в формат "Фамилия И.")
     * Объем заготовки или трелёвки (в м³)

3. **Определение целевого листа**
   - Автоматический поиск соответствующего листа в целевой книге Excel по дате из имени файла
   - Использование AI (GPT-3.5) для точного сопоставления периодов

4. **Обновление данных**
   - Поиск строки оператора по ФИО
   - Обновление значений в столбце "заготовка (треллевка) (погрузка) (м³)"

## Целевая таблица
- Название: "Эффективность заготовки"
- Формат данных: для каждого оператора обновляется объем заготовки/трелёвки в соответствующем месяце

## Особенности
- Автоматическое форматирование ФИО операторов в краткий формат
- Интеллектуальное определение соответствующего месяца в целевой таблице
- Поддержка различных форматов входных данных (заготовка/трелёвка)
- Обработка числовых значений с учетом возможных форматов (разделители "," и ".")

## Обработка ошибок
- Проверка наличия обязательных данных (ФИО оператора, значения объема)
- Пропуск записей с неполными данными
- Валидация соответствия периодов

## Требуемые подключения
1. Google Drive API (для доступа к файлам)
2. Microsoft Excel OAuth2 (для работы с целевой таблицей)
3. OpenAI API (для интеллектуального сопоставления дат)

## Примечание
Для корректной работы workflow необходимо настроить учетные данные для всех используемых сервисов и убедиться в наличии прав доступа к соответствующим папкам и файлам.